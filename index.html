
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ¸ æ·‡æ·‡ä¸åŠ ç›çš„å°çº¢èŠ±ä»“åº“ ğŸŒ¸</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --main-pink: #ffafbd;
            --soft-orange: #ffc3a0;
            --dark-pink: #ff6b81;
            --bg-pink: #fff5f7;
        }

        body {
            font-family: 'PingFang SC','Microsoft YaHei',sans-serif;
            background-color: var(--bg-pink);
            background-image: radial-gradient(#ffcad4 0.5px, transparent 0.5px);
            background-size: 20px 20px;
            color: #4a4a4a;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container { width:100%; max-width:600px; }

        .header-card {
            background:white;
            border-radius:30px;
            padding:30px 20px;
            text-align:center;
            box-shadow:0 10px 30px rgba(255,175,189,.4);
            border:3px solid var(--main-pink);
        }

        .main-flower-img { font-size:60px; animation:floating 3s infinite; }
        .title { color:var(--dark-pink); font-size:1.5rem; font-weight:bold; }
        .level-title {
            display:inline-block;
            background:linear-gradient(135deg,#fff0f3,#ffe0e6);
            color:var(--dark-pink);
            padding:5px 15px;
            border-radius:20px;
            font-size:.9rem;
            font-weight:bold;
        }

        .flower-display { display:flex; justify-content:center; align-items:baseline; }
        .flower-count { font-size:5rem; font-weight:900; color:var(--dark-pink); }
        .flower-unit { margin-left:10px; color:var(--main-pink); font-weight:bold; }

        .btn-group { display:flex; gap:15px; margin-top:15px; }
        .btn-add {
            background:linear-gradient(135deg,var(--main-pink),var(--dark-pink));
            color:white;border:none;padding:12px 30px;border-radius:50px;
            font-weight:bold;cursor:pointer;
        }
        .btn-reduce {
            background:white;color:var(--main-pink);
            border:2px solid var(--main-pink);
            padding:12px 20px;border-radius:50px;font-weight:bold;
        }

        .log-section {
            background:white;border-radius:20px;padding:20px;margin-top:20px;
            box-shadow:0 5px 15px rgba(0,0,0,.05);
        }

        .log-item {
            display:flex;justify-content:space-between;align-items:center;
            border-bottom:1px dashed #eee;padding:10px 0;font-size:.85rem;
        }

        .log-content { display:flex;flex-direction:column;gap:4px; }
        .log-time { color:#bbb;font-size:.75rem; }

        .btn-delete-log {
            background:#fff0f3;color:var(--dark-pink);
            border:none;width:24px;height:24px;border-radius:50%;
            cursor:pointer;
        }

        .reward-section-title {
            text-align:center;color:var(--dark-pink);
            margin:30px 0 15px;font-size:1.2rem;
        }

        .reward-card {
            background:white;border-radius:20px;padding:20px;margin-bottom:15px;
            box-shadow:0 5px 15px rgba(0,0,0,.05);
            border-left:8px solid var(--main-pink);
        }

        .reward-header { display:flex;justify-content:space-between; }
        .reward-cost {
            background:#fff0f3;color:var(--dark-pink);
            padding:5px 15px;border-radius:20px;font-weight:bold;
        }

        .btn-redeem {
            align-self:flex-end;margin-top:15px;
            background:var(--main-pink);color:white;border:none;
            padding:8px 20px;border-radius:12px;font-weight:bold;
        }

        .btn-redeem:disabled { background:#eee;color:#bbb; }

        /* ===== å›¾ç‰‡å¼¹çª— ===== */
        .modal {
            position:fixed;inset:0;background:rgba(0,0,0,.6);
            display:none;justify-content:center;align-items:center;z-index:999;
        }

        .modal-box {
            background:white;border-radius:20px;
            width:90%;max-width:360px;padding:15px;
        }

        .modal-image-wrapper { position:relative; }
        .modal-image-wrapper img {
            width:100%;max-height:240px;object-fit:contain;border-radius:12px;
        }

        .img-delete-btn {
            position:absolute;top:6px;right:6px;
            background:rgba(0,0,0,.6);color:white;
            border:none;border-radius:50%;width:22px;height:22px;
        }

        .slider-controls {
            display:flex;justify-content:space-between;margin:10px 0;
        }

        .slider-btn {
            background:#fff0f3;border:none;border-radius:10px;
            padding:6px 12px;color:var(--dark-pink);
        }

        @keyframes floating {
            0%{transform:translateY(0)}
            50%{transform:translateY(-5px)}
            100%{transform:translateY(0)}
        }
    </style>
</head>

<body>

<div class="container">
    <div class="header-card">
        <span class="main-flower-img">ğŸŒ¸</span>
        <div class="title">æ·‡æ·‡ä¸åŠ ç›å®è´çš„å°çº¢èŠ±ä»“åº“</div>
        <div id="levelBadge" class="level-title"></div>

        <div class="flower-display">
            <div class="flower-count" id="totalCount">0</div>
            <div class="flower-unit">æœµå°çº¢èŠ±</div>
        </div>

        <div class="btn-group">
            <button class="btn-reduce" onclick="changeFlower(-1)">å‡å°‘ ğŸŒ¸ -1</button>
            <button class="btn-add" onclick="changeFlower(1)">ç‚¹å‡»è·å¾— ğŸŒ¸ +1</button>
        </div>
    </div>

    <div class="log-section">
        <div style="font-weight:bold;color:var(--dark-pink)">ğŸ“œ å…‘æ¢è®°å½•</div>
        <div id="logList"></div>
    </div>

    <div class="reward-section-title">â€”â€” å¥–åŠ±å…‘æ¢åŒº â€”â€”</div>
    <div id="rewardContainer"></div>
</div>

<!-- å›¾ç‰‡å¼¹çª— -->
<div id="imgModal" class="modal">
    <div class="modal-box">
        <div class="modal-image-wrapper">
            <img id="modalImg">
            <button class="img-delete-btn" onclick="deleteCurrentImage()">âœ•</button>
        </div>
        <div class="slider-controls">
            <button class="slider-btn" onclick="prevImg()">â†</button>
            <button class="slider-btn" onclick="nextImg()">â†’</button>
        </div>
        <button class="slider-btn" style="width:100%" onclick="closeModal()">å…³é—­</button>
    </div>
</div>
<div class="rules-card">
        <span style="color:var(--dark-pink); font-weight:bold; display:block; text-align:center; margin-bottom:10px;">ğŸŒ¸ã€éšè—è§„åˆ™ã€‘ğŸŒ¸</span>
        å°çº¢èŠ±å¯ä»¥ç´¯è®¡ã€ä¸æ¸…é›¶ï¼Œä½†æ˜¯æœ‰å¯èƒ½ä¼šè§¦å‘æ‰£é™¤æœºåˆ¶å“¦~<br>
        ç‰¹æ®Šè¡¨ç°ä¼˜ç§€æ—¶ï¼Œæ·‡æ·‡æœ‰æƒé¢å¤–å¥–åŠ±å°çº¢èŠ±<br>
        æœ¬åˆ¶åº¦é•¿æœŸæœ‰æ•ˆï¼Œè§£é‡Šæƒå½’æ·‡æ·‡ & åŠ ç›å®è´å…±åŒæ‰€æœ‰
    </div>
<script>
/* ===== åŸæœ‰é€»è¾‘ ===== */
const rewardData = [
        { cost: 1, text: "ä¸€æ¬¡å°å¥–åŠ±ï¼å¯ä»¥è®©æ·‡æ·‡ç»™åŠ ç›å®è´ä¹°å¥½å–çš„å¥¶èŒ¶ï¼Œå¥½åƒçš„å°è›‹ç³•ï¼Œé¢åŒ…ç­‰ç­‰~" },
        { cost: 2, text: "æŒ‡å®šä¸€æ¬¡â€œä»Šå¤©ä½ è¯´äº†ç®—â€ï¼Œå¯ä»¥è®©æ·‡æ·‡ç»™åŠ ç›å®è´å®Œæˆä¸€ä»¶äº‹æƒ…ï¼Œä¸åšé™åˆ¶å“¦ï¼æˆ–è€…ä¹Ÿå¯ä»¥åœ¨çº¦ä¼šçš„æ—¶å€™å¯ä»¥æŒ‡å®šä¸€æ¬¡ä»Šå¤©å»å“ªåƒï¼Œæˆ–è€…ä»Šå¤©çœ‹ä»€ä¹ˆï¼Œæˆ–è€…æƒ³å»æŠ“å¨ƒå¨ƒå•Šï¼Œé€›ç¾é£Ÿè¡—å•Šï¼Œæƒ³çœ‹çš„ç”µå½±å•Šï¼Œä»¥åŠæŠ–éŸ³åˆ·åˆ°äº†æœ‰å¾ˆæƒ³å»çš„åº—ç„¶åæƒ³å«æ·‡æ·‡ä¸€èµ·å»æ‰“å¡å‘€ä¹‹ç±»çš„ï¼Œåªè¦å…‘æ¢ï¼Œè§é¢ä¸€å®šæ»¡è¶³~" },
        { cost: 5, text: "ä¸€æ¬¡å°ç¤¼ç‰©~åŒ…æ‹¬ä½†ä¸é™äºæƒ³è¦çš„ç©å¶ï¼Œæƒ…ä¾£å°ç¤¼ç‰©å‘€~ï¼ˆå¯¹æˆ’/æ‰‹ç»³/é’¥åŒ™æ‰£ï¼‰ä¹‹ç±»çš„" },
        { cost: 5, text: "ä¸€å¼ å…ç”Ÿæ°”å·ï¼å¦‚æœæ·‡æ·‡å› ä¸ºä¸€ä»¶äº‹ç”Ÿæ°”ï¼ŒåŠ ç›å®è´å¯ä»¥åœ¨åˆç†èŒƒå›´å†…ä½¿ç”¨æ­¤å·ï¼ŒéåŸåˆ™é—®é¢˜100%ç”Ÿæ•ˆ" },
        { cost: 5, text: "ä¸€å¼ é¢å¤–è§é¢å·ï¼Œå¦‚æœåŠ ç›å®è´å“ªå¤©ç‰¹åˆ«æƒ³æ·‡æ·‡ï¼Œç‰¹åˆ«æƒ³è§æˆ‘ï¼Œä½†æ˜¯è¿˜æ²¡åˆ°è§é¢æ—¥æœŸï¼Œå¯ä»¥ä½¿ç”¨æ­¤å·ï¼Œæ·‡æ·‡æ‰¿è¯ºä¼šåœ¨å¤„ç†å¥½äº‹æƒ…åï¼Œä»¥æœ€å¿«çš„é€Ÿåº¦å½“å¤©èµ¶åˆ°åŠ ç›å®è´èº«è¾¹" },
        { cost: 6, text: "æ·‡æ·‡äº²æ‰‹å‡†å¤‡çš„å°æƒŠå–œï¼ˆä¸å¯å…‘æ¢ï¼Œä½œä¸ºéšè—åŠŸèƒ½ï¼Œåœ¨æ»¡è¶³ä¸€å®šè¦æ±‚åè‡ªåŠ¨è§£é”ï¼‰", locked: true },
        { cost: 8, text: "æƒ…ä¾£ä¸“å±æŒ‘æˆ˜æˆ–å°æ¸¸æˆä¸€æ¬¡æŠ“å¨ƒå¨ƒæ¯”èµ›ï¼ˆè¾“çš„äººæœ‰æƒ©ç½šï¼‰æ¡Œæ¸¸/ç”µç©/å°æ¸¸æˆæƒ…ä¾£å°ä»»åŠ¡ ï¼ˆåŠ ç›å®è´æ‹¥æœ‰ä¸€å®šâ€œä½œå¼Šæƒâ€ï¼Œå˜¿å˜¿ï¼‰" },
        { cost: 10, text: "â€œä¸€æ•´å¤©å¥³å‹ç‰¹æƒæ—¥â€ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºå¥½æƒ³æ¥ä¹°å°é›¶é£Ÿï¼Œ1åˆ†é’Ÿï¼ŒåŠ ç›å®è´æŠ“åˆ°å¤šå°‘ä¹°å¤šå°‘é™æ—¶è´­ç‰©ï¼Œæ·‡æ·‡æŠ¥é”€æˆ–è€…ç¾é£Ÿè¡—æ‰€æœ‰æƒ³åƒçš„ï¼Œæƒ³åƒä»€ä¹ˆä¹°ä»€ä¹ˆï¼Œä¸ç”¨æ‹…å¿ƒæµªè´¹ï¼åœ¨è¿™ä¸€å¤©ï¼ŒåŠ ç›å®è´æ‰€æœ‰çš„è¦æ±‚æ·‡æ·‡éƒ½å°†å°½é‡æ»¡è¶³ï¼è€Œä¸”ä¼šä¿æŒè¶…é«˜æœåŠ¡æ€åº¦ï¼ä¸è¿‡é€›è¡—çš„æ—¶å€™åŠ ç›å®è´è¦æŒ½ç€èƒ³è†Šï¼Œå˜¿å˜¿ï¼ˆé™¤äº†æ‘˜æ˜Ÿæ˜Ÿè¿™ç§å®åœ¨ä¸å¤ªè¡Œï¼Œå˜¿å˜¿ï¼‰" },
        { cost: 10, text: "ä¸€ä¸ªä¸­ç­‰å¥–åŠ±ï¼Œè¿‘æœŸåŠ ç›å®è´è´­ç‰©è½¦éšæœºä¸€ä»¶ä¸­ç­‰èŒƒå›´å†…æŠ¥é”€!" },
        { cost: 10, text: "åŠ ç›å®è´ç‰¹åˆ«æƒ³è¦çš„åŒ–å¦†å“æˆ–è€…æŠ¤è‚¤å“ä¸€ä»¶" },
        { cost: 12, text: "ä¸“å±çºªå¿µæ—¥è‡ªå®šä¹‰\nåŠ ç›å®è´å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªæˆ‘ä»¬çš„å°çºªå¿µæ—¥ï¼Œæ·‡æ·‡éœ€åœ¨æ¯å¹´/æ¯æ¬¡è®¤çœŸå¯¹å¾…\nä¸å¯æ•·è¡ã€ä¸è®¸å¿˜è®°" },
        { cost: 15, text: "çº¦ä¼šé¢å¤–é¡¹ç›®ï¼Œå¦‚æ³¡æ¸©æ³‰å•Šï¼ŒçŸ­é€”å°æ—…è¡Œå•Š~ä¹‹ç±»çš„ï¼Œæœ‰å¾ˆå¤§çš„æ‰©å±•æ€§å“¦~å¯ä»¥è‡ªå·±æƒ³æƒ³ä¸€ä¸‹ï¼ˆç‰¹æ®Šæ·»åŠ ï¼šé‰´äºæ·‡æ·‡æœ€è¿‘åˆ·åˆ°ç¯çƒäº†æ„Ÿè§‰ç‰¹åˆ«å–œæ¬¢ï¼Œæ‰€ä»¥æ·»åŠ ä¸ŠåŒ—äº¬ç¯çƒå’Œè¿ªå£«å°¼ï¼Œä¸è¿‡è¿™ä¸¤ä¸ªå°çº¢èŠ±ä»·æ ¼è°ƒæ•´ä¸º20å“¦~å˜¿å˜¿ï¼‰" },
        { cost: 15, text: "åŠ ç›å®è´å¯ä»¥ç»™æ·‡æ·‡æä¸€ä¸ªç”Ÿæ´»æ–¹å¼æˆ–è€…ä¹ æƒ¯çš„è¦æ±‚ï¼æ·‡æ·‡ä¼šæ ¹æ®è¦æ±‚è¿›è¡Œè°ƒæ•´~" },
        { cost: 18, text: "ä¸€æ¬¡é«˜çº§æµªæ¼«çº¦ä¼šï¼æ¯”æ™®é€šçº¦ä¼šæ›´æ­£å¼ã€æ›´æœ‰ä»ªå¼æ„Ÿ" },
        { cost: 20, text: "ä¸€ä¸ªå¤§å¥–åŠ±ï¼Œéä»»ä½•èŠ‚æ—¥ä¹Ÿå¯ä»¥å…‘æ¢ï¼Œç»™åŠ ç›å®è´è´­ç‰©è½¦å†…éšæœºä¸€ä»¶æƒ³è¦çš„ä½†æ˜¯æ²¡èˆå¾—ä¹°çš„æ·‡æ·‡æŠ¥é”€ï¼æˆ–è€…å¯ä»¥å…‘æ¢ç‰©å“ï¼Œæ·‡æ·‡ç»™åŠ ç›å®è´ä¹°ï¼Œå¦‚æˆ‘æƒ³è¦ä¸ªæ‰‹é“¾ï¼Œæˆ‘æƒ³è¦ä¸ªé¦–é¥°ï¼Œæƒ³è¦ä¸ªæˆ’æŒ‡~ä¹‹ç±»çš„ï¼Œæˆ–è€…æœ‰å–œæ¬¢çš„è¡£æœä½†æ˜¯è¿˜æ²¡ä¹°çš„ï¼ŒæŠ¥é”€ï¼" },
        { cost: 30, text: "å®ç°åŠ ç›å®è´ä¸€ä¸ªå¿ƒæ„¿ï¼Œä¸åšé™åˆ¶ã€‚" }
    ];
let count = parseInt(localStorage.getItem('flower_count')) || 0;
let logs = JSON.parse(localStorage.getItem('flower_logs')) || [];

/* ===== å›¾ç‰‡å¼¹çª—æ•°æ® ===== */
let modalImages = [
    "https://picsum.photos/400/300?1",
    "https://picsum.photos/400/300?2"
];
let currentImgIndex = 0;

function init() {
    updateDisplay();
    renderLogs();
}
init();

function changeFlower(n) {
    if (count + n < 0) return;
    count += n;
    triggerConfetti();
    updateDisplay();
}

function updateDisplay() {
    document.getElementById('totalCount').innerText = count;
    document.getElementById('levelBadge').innerText =
        count <= 10 ? "ğŸŒ± åˆçº§ä¹–ä¹–å®è´" :
        count <= 30 ? "â­ æ¨¡èŒƒä¹–ä¹–å®è´" :
        count < 50 ? "ğŸ‘‘ èµ„æ·±ä¹–ä¹–å®è´" :
        "ğŸŒŒ é“¶æ²³ç³»æœ€æœ€å¯çˆ±çš„åŠ ç›å®è´";
    localStorage.setItem('flower_count', count);
    renderRewards();
}

function renderRewards() {
    const c = document.getElementById('rewardContainer');
    c.innerHTML = '';
    rewardData.forEach((r,i)=>{
        c.innerHTML += `
        <div class="reward-card">
            <div class="reward-header">
                <span>é¡¹ç›® #${i+1}</span>
                <span class="reward-cost">${r.cost} ğŸŒ¸</span>
            </div>
            <div>${r.text}</div>
            <button class="btn-redeem" ${count<r.cost?'disabled':''}
                onclick="redeem(${r.cost})">ç«‹å³å…‘æ¢</button>
        </div>`;
    });
}

function redeem(cost){
    count -= cost;
    logs.unshift({
        id:Date.now(),
        time:new Date().toLocaleString(),
        content:`å…‘æ¢ ${cost} ğŸŒ¸`
    });
    localStorage.setItem('flower_logs',JSON.stringify(logs));
    updateDisplay();
    renderLogs();
}

/* ===== æ—¥å¿— ===== */
function renderLogs(){
    const l = document.getElementById('logList');
    if(!logs.length){ l.innerHTML='è¿˜æ²¡æœ‰è®°å½•å“¦~'; return; }
    l.innerHTML = logs.map(i=>`
        <div class="log-item">
            <div class="log-content">
                <span>${i.content}</span>
                <span class="log-time">${i.time}</span>
            </div>
            <button class="btn-delete-log" onclick="deleteLog(${i.id})">âœ•</button>
        </div>`).join('');
}

function deleteLog(id){
    logs = logs.filter(l=>l.id!==id);
    localStorage.setItem('flower_logs',JSON.stringify(logs));
    renderLogs();
}

/* ===== å›¾ç‰‡å¼¹çª—é€»è¾‘ ===== */
function openModal(index=0){
    currentImgIndex=index;
    document.getElementById('imgModal').style.display='flex';
    renderModalImage();
}
function closeModal(){
    document.getElementById('imgModal').style.display='none';
}
function renderModalImage(){
    document.getElementById('modalImg').src = modalImages[currentImgIndex];
}
function prevImg(){
    currentImgIndex=(currentImgIndex-1+modalImages.length)%modalImages.length;
    renderModalImage();
}
function nextImg(){
    currentImgIndex=(currentImgIndex+1)%modalImages.length;
    renderModalImage();
}
function deleteCurrentImage(){
    modalImages.splice(currentImgIndex,1);
    if(!modalImages.length){ closeModal(); return; }
    currentImgIndex%=modalImages.length;
    renderModalImage();
}

function triggerConfetti(){
    confetti({particleCount:80,spread:60,origin:{y:.6}});
}
</script>

</body>
</html>
